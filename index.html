<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –±–æ—è</title>
  <link href="https://fonts.googleapis.com/css2?family=Century+Gothic&display=swap" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: 'Century Gothic', sans-serif;
      background-color: #f2f2f2;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }

    .calculator {
      background-color: white;
      padding: 30px 40px;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      width: 100%;
      max-width: 600px;
      text-align: center;
      animation: fadeIn 0.6s ease-out;
    }

    h2 {
      font-size: 2rem;
      color: #579e21;
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
    }

    input[type="number"] {
      padding: 8px;
      width: 80px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 1rem;
    }

    button {
      margin-top: 20px;
      padding: 12px 20px;
      background-color: #579e21;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1rem;
      transition: background-color 0.3s ease;
    }

    button:hover {
      background-color: #4a8e1c;
    }

    .result {
      margin-top: 25px;
      padding: 15px;
      border-radius: 8px;
      font-size: 1rem;
      opacity: 0;
      transform: translateY(20px);
      animation: fadeInUp 0.6s forwards;
    }

    .win {
      background-color: #eaffec;
      color: #2b691d;
    }

    .lose {
      background-color: #ffeaea;
      color: #570600;
    }

    .draw {
      background-color: #fff8dc;
      color: #666;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes fadeInUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .damage-flash {
      animation: flash 0.3s ease-in-out;
    }

    @keyframes flash {
      0% { background-color: transparent; }
      50% { background-color: #ffdddd; }
      100% { background-color: transparent; }
    }
  </style>
</head>
<body>

<div class="calculator">
  <h2>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –±–æ—è</h2>
  <form id="battleForm">
    <h3>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ò–≥—Ä–æ–∫–∞:</h3>
    <label>–°–ò–õ–ê: <input type="number" name="playerStr" value="8"></label><br>
    <label>–ó–ê–©–ò–¢–ê: <input type="number" name="playerDef" value="10"></label><br>
    <label>–ò–ù–ò–¶–ò–ê–¢–ò–í–ê: <input type="number" name="playerInit" value="10"></label><br>

    <h3>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ü—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞:</h3>
    <label>–°–ò–õ–ê: <input type="number" name="enemyStr" value="11"></label><br>
    <label>–ó–ê–©–ò–¢–ê: <input type="number" name="enemyDef" value="7"></label><br>
    <label>–ò–ù–ò–¶–ò–ê–¢–ò–í–ê: <input type="number" name="enemyInit" value="9"></label><br>

    <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ê–¢–ê–ö: <input type="number" name="rounds" value="4"></label><br>

    <button type="button" onclick="simulateBattle()">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –±–æ–π</button>
  </form>

  <div class="result" id="result" style="display:none;"></div>
</div>

<script>
  function attack(attacker, defender) {
    const damage = attacker.—Å–∏–ª–∞;

    if (defender.–∑–∞—â–∏—Ç–∞ > 0) {
      defender.–∑–∞—â–∏—Ç–∞ -= damage;
      if (defender.–∑–∞—â–∏—Ç–∞ < 0) {
        defender.—Å–∏–ª–∞ += defender.–∑–∞—â–∏—Ç–∞;
        defender.–∑–∞—â–∏—Ç–∞ = 0;
      }
    } else {
      defender.—Å–∏–ª–∞ -= damage;
    }

    return defender;
  }

  function simulateBattle() {
    const form = document.getElementById('battleForm');

    // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã
    let player = {
      —Å–∏–ª–∞: parseInt(form.playerStr.value),
      –∑–∞—â–∏—Ç–∞: parseInt(form.playerDef.value),
      –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–∞: parseInt(form.playerInit.value)
    };

    let enemy = {
      —Å–∏–ª–∞: parseInt(form.enemyStr.value),
      –∑–∞—â–∏—Ç–∞: parseInt(form.enemyDef.value),
      –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–∞: parseInt(form.enemyInit.value)
    };

    let rounds = parseInt(form.rounds.value);

    // –ö–æ–ø–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤ –¥–ª—è —Ä–∞—Å—á—ë—Ç–æ–≤
    let p = JSON.parse(JSON.stringify(player));
    let e = JSON.parse(JSON.stringify(enemy));

    let winner = null;
    let playerAttacks = 0;
    let enemyAttacks = 0;

    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –∫—Ç–æ —Ö–æ–¥–∏—Ç –ø–µ—Ä–≤—ã–º
    let first = p.–∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–∞ >= e.–∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–∞ ? "player" : "enemy";

    for (let i = 0; i < rounds; i++) {
      // –ê—Ç–∞–∫–∞ –∏–≥—Ä–æ–∫–∞
      if (p.—Å–∏–ª–∞ > 0) {
        e = attack(p, e);
        playerAttacks++;
        if (e.—Å–∏–ª–∞ <= 0) {
          winner = "–ò–≥—Ä–æ–∫";
          break;
        }
      }

      // –ê—Ç–∞–∫–∞ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞
      if (e.—Å–∏–ª–∞ > 0) {
        p = attack(e, p);
        enemyAttacks++;
        if (p.—Å–∏–ª–∞ <= 0) {
          winner = "–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫";
          break;
        }
      }
    }

    const resultDiv = document.getElementById('result');
    resultDiv.style.display = 'block';
    resultDiv.classList.remove("win", "lose", "draw", "damage-flash");
    resultDiv.style.opacity = 0;

    setTimeout(() => {
      resultDiv.style.opacity = 1;
    }, 10);

    let resultText = `<strong>–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ ${playerAttacks} –∞—Ç–∞–∫ –ò–≥—Ä–æ–∫–∞ –∏ ${enemyAttacks} –∞—Ç–∞–∫ –ü—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞:</strong><br>`;
    resultText += `–ò–≥—Ä–æ–∫: –°–ò–õ–ê ‚Äî ${p.—Å–∏–ª–∞}, –ó–ê–©–ò–¢–ê ‚Äî ${p.–∑–∞—â–∏—Ç–∞}<br>`;
    resultText += `–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫: –°–ò–õ–ê ‚Äî ${e.—Å–∏–ª–∞}, –ó–ê–©–ò–¢–ê ‚Äî ${e.–∑–∞—â–∏—Ç–∞}<br><br>`;

    if (winner === "–ò–≥—Ä–æ–∫") {
      resultText += "üéâ –í—ã –ø–æ–±–µ–¥–∏–ª–∏!";
      resultDiv.classList.add("win");
    } else if (winner === "–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫") {
      resultText += "üí• –í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏.";
      resultDiv.classList.add("lose");
    } else {
      resultText += "ü§ù –ù–∏—á—å—è.";
      resultDiv.classList.add("draw");
    }

    resultDiv.innerHTML = resultText;
    resultDiv.classList.add("damage-flash");
  }
</script>

</body>
</html>